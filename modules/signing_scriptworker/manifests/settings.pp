# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.
class signing_scriptworker::settings {
    include ::config
    include python3::settings

    $root               = $config::scriptworker_root
    $task_max_timeout   = 7200
    $task_script        = "${root}/bin/signingscript"
    $task_script_config = "${root}/script_config.json"
    $verbose            = true
    $virtualenv_version = $python3::settings::python3_virtualenv_version

    $env_config = {
        'dev' => {
            worker_type              => 'signing-linux-dev',
            worker_group             => 'signing-linux-v1',
            taskcluster_client_id    => secret('dev_signing_scriptworker_taskcluster_client_id'),
            taskcluster_access_token => secret('dev_signing_scriptworker_taskcluster_access_token'),
            passwords_template       => 'dep-passwords.json.erb',
            scope_prefixes           => ['project:releng:signing:'],
            sign_chain_of_trust      => false,
            verify_chain_of_trust    => true,
            verify_cot_signature     => false,
            cot_product              => 'firefox',
            github_oauth_token       => '',
            gpg_keyfile              => 'KEY_dep',
            widevine_cert            => 'widevine_dep.crt',
            authenticode_cert        => 'dep.crt',
            authenticode_url         => 'https://mozilla.com',
            authenticode_timestamp   => 'null',
        },
        'dep' => {
            worker_type              => 'depsigning',
            worker_group             => 'signing-linux-v1',
            taskcluster_client_id    => secret('dep_signing_scriptworker_taskcluster_client_id'),
            taskcluster_access_token => secret('dep_signing_scriptworker_taskcluster_access_token'),
            passwords_template       => 'dep-passwords.json.erb',
            scope_prefixes           => ['project:releng:signing:'],
            sign_chain_of_trust      => false,
            verify_chain_of_trust    => true,
            verify_cot_signature     => false,
            cot_product              => 'firefox',
            github_oauth_token       => '',
            gpg_keyfile              => 'KEY_dep',
            widevine_cert            => 'widevine_dep.crt',
            authenticode_cert        => 'dep.crt',
            authenticode_url         => 'https://mozilla.com',
            authenticode_timestamp   => 'null',
        },
        'prod' => {
            worker_type              => 'signing-linux-v1',
            worker_group             => 'signing-linux-v1',
            taskcluster_client_id    => secret('signing_scriptworker_taskcluster_client_id'),
            taskcluster_access_token => secret('signing_scriptworker_taskcluster_access_token'),
            passwords_template       => 'passwords.json.erb',
            scope_prefixes           => ['project:releng:signing:'],
            sign_chain_of_trust      => true,
            verify_chain_of_trust    => true,
            verify_cot_signature     => true,
            cot_product              => 'firefox',
            github_oauth_token       => '',
            gpg_keyfile              => 'KEY_prod',
            widevine_cert            => 'widevine_prod.crt',
            authenticode_cert        => 'nightly.crt',
            authenticode_url         => 'https://mozilla.com',
            authenticode_timestamp   => '"old"',
        },
        'comm-thunderbird-dep' => {
            worker_type              => 'tb-depsigning',
            worker_group             => 'tb-depsigning',
            taskcluster_client_id    => secret('comm_thunderbird_dep_signing_scriptworker_taskcluster_client_id'),
            taskcluster_access_token => secret('comm_thunderbird_dep_signing_scriptworker_taskcluster_access_token'),
            passwords_template       => 'dep-passwords.json.erb',
            scope_prefixes           => ['project:comm:thunderbird:releng:signing:'],
            sign_chain_of_trust      => false,
            verify_chain_of_trust    => true,
            verify_cot_signature     => false,
            cot_product              => 'thunderbird',
            github_oauth_token       => '',
            gpg_keyfile              => 'KEY_dep',
            authenticode_cert        => 'dep.crt',
            authenticode_url         => 'https://mozilla.com',
            authenticode_timestamp   => 'null',
        },
        'comm-thunderbird-prod' => {
            worker_type              => 'tb-signing-v1',
            worker_group             => 'signing-linux-v1',
            taskcluster_client_id    => 'project/comm/thunderbird/releng/scriptworker/signingworker',
            taskcluster_access_token => secret('comm_thunderbird_signing_scriptworker_taskcluster_access_token'),
            passwords_template       => 'passwords.json.erb',
            scope_prefixes           => ['project:comm:thunderbird:releng:signing:'],
            sign_chain_of_trust      => true,
            verify_chain_of_trust    => true,
            verify_cot_signature     => true,
            cot_product              => 'thunderbird',
            github_oauth_token       => '',
            gpg_keyfile              => 'KEY_prod',
            authenticode_cert        => 'nightly.crt',
            authenticode_timestamp   => '"old"',
            authenticode_url         => 'https://mozilla.com',
        },
        'mobile-dep' => {
            worker_type              => 'mobile-signing-dep-v1',
            worker_group             => 'mobile-signing-dep-v1',
            taskcluster_client_id    => 'project/mobile/focus/releng/scriptworker/signing/dep',
            taskcluster_access_token => secret('mobile_focus_signing_dep_scriptworker_taskcluster_access_token'),
            passwords_template       => 'dep-passwords-mobile.json.erb',
            scope_prefixes           => ['project:mobile:focus:releng:signing:', 'project:mobile:android-components:releng:signing:', 'project:mobile:fenix:releng:signing:', 'project:mobile:reference-browser:releng:signing:', 'project:mobile:firefox-tv:releng:signing:'],
            sign_chain_of_trust      => false,
            verify_chain_of_trust    => true,
            verify_cot_signature     => false,
            cot_product              => 'mobile',
            github_oauth_token       => secret('scriptworker_github_oauth_token_staging'),
            gpg_keyfile              => 'KEY_dep',
            authenticode_cert        => '',
            authenticode_timestamp   => 'null',
            authenticode_url         => '',
        },
        'mobile-prod' => {
            worker_type              => 'mobile-signing-v1',
            worker_group             => 'mobile-signing-v1',
            taskcluster_client_id    => 'project/mobile/focus/releng/scriptworker/signing/production',
            taskcluster_access_token => secret('mobile_focus_signing_scriptworker_taskcluster_access_token'),
            passwords_template       => 'passwords-mobile.json.erb',
            scope_prefixes           => ['project:mobile:focus:releng:signing:', 'project:mobile:android-components:releng:signing:', 'project:mobile:fenix:releng:signing:', 'project:mobile:reference-browser:releng:signing:', 'project:mobile:firefox-tv:releng:signing:'],
            sign_chain_of_trust      => true,
            verify_chain_of_trust    => true,
            verify_cot_signature     => true,
            cot_product              => 'mobile',
            github_oauth_token       => secret('scriptworker_github_oauth_token_production'),
            gpg_keyfile              => 'KEY_dep',
            authenticode_cert        => '',
            authenticode_timestamp   => 'null',
            authenticode_url         => '',
        },
        'appsv-dep' => {
            worker_type              => 'appsv-signing-dep-v1',
            worker_group             => 'appsv-signing-dep-v1',
            taskcluster_client_id    => 'project/mozilla/application-services/releng/scriptworker/signing/dep',
            taskcluster_access_token => secret('application_services_signing_dep_scriptworker_taskcluster_access_token'),
            passwords_template       => 'dep-passwords-appsv.json.erb',
            scope_prefixes           => ['project:mozilla:application-services:releng:signing'],
            sign_chain_of_trust      => false,
            verify_chain_of_trust    => true,
            verify_cot_signature     => false,
            cot_product              => 'application-services',
            github_oauth_token       => secret('scriptworker_github_oauth_token_staging'),
            gpg_keyfile              => 'KEY_dep',
            authenticode_cert        => '',
            authenticode_timestamp   => 'null',
            authenticode_url         => '',
        },
        'appsv-prod' => {
            worker_type              => 'appsv-signing-v1',
            worker_group             => 'appsv-signing-v1',
            taskcluster_client_id    => 'project/mozilla/application-services/releng/scriptworker/signing/production',
            taskcluster_access_token => secret('application_services_signing_scriptworker_taskcluster_access_token'),
            passwords_template       => 'passwords-appsv.json.erb',
            scope_prefixes           => ['project:mozilla:application-services:releng:signing'],
            sign_chain_of_trust      => true,
            verify_chain_of_trust    => true,
            verify_cot_signature     => true,
            cot_product              => 'application-services',
            github_oauth_token       => secret('scriptworker_github_oauth_token_production'),
            gpg_keyfile              => 'KEY_prod',
            authenticode_cert        => '',
            authenticode_timestamp   => 'null',
            authenticode_url         => '',
        },
        'dep-xpi' => {
            worker_type              => 'xpi-t-signing',
            worker_group             => 'signing-linux-v1',
            taskcluster_client_id    => 'project/releng/scriptworker/xpi-t-signing',
            taskcluster_access_token => secret('xpi_dep_signing_scriptworker_taskcluster_access_token'),
            passwords_template       => 'dep-passwords-xpi.json.erb',
            scope_prefixes           => ['project:xpi:releng:signing:'],
            sign_chain_of_trust      => false,
            verify_chain_of_trust    => true,
            verify_cot_signature     => false,
            cot_product              => 'xpi',
            github_oauth_token       => secret('scriptworker_github_oauth_token_staging'),
            gpg_keyfile              => 'KEY_dep',
            widevine_cert            => 'widevine_dep.crt',
            authenticode_cert        => 'dep.crt',
            authenticode_url         => 'https://mozilla.com',
            authenticode_timestamp   => 'null',
        },
        'prod-xpi' => {
            worker_type              => 'xpi-3-signing',
            worker_group             => 'signing-linux-v1',
            taskcluster_client_id    => 'project/releng/scriptworker/xpi-3-signing',
            taskcluster_access_token => secret('xpi_prod_signing_scriptworker_taskcluster_access_token'),
            passwords_template       => 'passwords-xpi.json.erb',
            scope_prefixes           => ['project:xpi:releng:signing:'],
            sign_chain_of_trust      => true,
            verify_chain_of_trust    => true,
            verify_cot_signature     => true,
            cot_product              => 'xpi',
            github_oauth_token       => secret('scriptworker_github_oauth_token_staging'),
            gpg_keyfile              => 'KEY_dep',
            widevine_cert            => 'widevine_dep.crt',
            authenticode_cert        => 'dep.crt',
            authenticode_url         => 'https://mozilla.com',
            authenticode_timestamp   => 'null',
        },
    }
}
